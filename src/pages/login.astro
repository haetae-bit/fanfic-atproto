---
import Layout from "../layouts/Layout.astro";
import Popover from "~/Popover.astro";

const currentUser = Astro.locals.loggedInUser;
---
<Layout>
  {
    currentUser ? (
      // If there's a current user, show the log out button
      <form action="/oauth/logout" method="post">
        <button type="submit">Logout</button>
      </form>
    ) : (
      // If there's no current user, show the log in button
      <form action="/oauth/login" method="post">
        <label for="handle">Input your handle
          <Popover label="help">
            <h3>What's my handle?</h3>
            <p>It'll look like a website URL without the <samp>https://</samp> or slashes, so a typical BlueSky handle will look something like: <b>alice.bsky.social</b>.</p>
            <p>What yours will look like depends on whether you made a custom handle!</p>
          </Popover>
        </label>
        <input name="atproto-id" id="handle" required />
        <button type="submit">Login</button>
      </form>
    )
  }
</Layout>